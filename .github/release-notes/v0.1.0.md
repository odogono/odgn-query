# odgn-query v0.1.0 (unreleased)

This release focuses on cross-runtime friendliness (Node/Deno/browser via LRU), better adapter ergonomics, correctness fixes, observability, and lifecycle tooling.

## Highlights
- Custom cache adapters: inject your own storage for Node/Deno (`adapter`/`adapterFactory`).
- Direct cache access: `getQueryData` / `setQueryData`.
- Lifecycle: `close()` on client + adapters.
- Observability: lightweight `stats()` + `resetStats()`.
- Maintenance: `gc()` to purge expired entries.
- Correctness: coalesced concurrent misses; safe async queueing for invalidations.

## Added
- Exported `CacheAdapter` contract from `src/cache` (also re-exported from package root).
- `QueryClient` options: `adapter`, `adapterFactory`, `defaultTtl`, `defaultBackgroundRefresh`.
- `QueryClient` methods: `getQueryData`, `setQueryData`, `close`, `stats`, `resetStats`, `gc`.
- LRU adapter (QueryCache): in-flight miss deduplication; `set`, `gc`, `close` (no-op).
- Redis adapter: `set`, `gc`, `close`; resolves `Bun.Redis` at runtime only when used.
- SQLite adapter: `set`, `gc`, `close`.
- Typed events: per-event channels (`HIT`, `MISS`, `FETCH`, etc.) plus aggregated `event` channel.

## Changed
- Queueing for `invalidate`, `invalidateQueries`, and `clear` now uses thunk-based enqueue to avoid premature execution / deadlocks.
- Client-level defaults for `ttl` and `backgroundRefresh` applied when not provided per query.

## Docs
- README: cross-runtime usage, custom adapter example, `getQueryData`/`setQueryData`, `close`, stats + gc usage.

## Notes
- Core remains Node/Deno/browser friendly by default (LRU). Redis/SQLite adapters are optional and require Bun at runtime only when selected.

---

### How to publish this release (manual)

1) Push the tag

```bash
git push origin v0.1.0
```

2) Create a draft GitHub release (requires GitHub CLI)

```bash
gh release create v0.1.0 --draft -F .github/release-notes/v0.1.0.md
```

3) Publish when ready (convert draft to published in UI or via `gh release edit`).
